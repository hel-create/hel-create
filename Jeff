# 计算每个 condo_counts 的总行数
total_counts = df_pc_match_stat.groupby('condo_counts').size()

# 计算每个 condo_counts 中 gross_rental_income 为 0 的行数
zero_gross_rental_income_counts = df_pc_match_stat[df_pc_match_stat['gross_rental_income'] == 0].groupby('condo_counts').size()

# 计算比例
proportion_zero_gross_rental_income = (zero_gross_rental_income_counts / total_counts).reset_index()
proportion_zero_gross_rental_income.columns = ['condo_counts', 'proportion_zero_gross_rental_income']

# 显示结果
print(proportion_zero_gross_rental_income)
